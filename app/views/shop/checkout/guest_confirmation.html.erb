<style>
  /* Guest confirmation print layout: add top margin on screen and print only the confirmation */
  .guest-confirmation-printable { margin-top: 20dvh; }

  @media print {
    /* hide everything by default */
    html, body { height: 100%; }
    body * { visibility: hidden; }

    /* reveal only the printable block */
    .guest-confirmation-printable, .guest-confirmation-printable * { visibility: visible; }
    .guest-confirmation-printable { position: absolute; left: 0; top: 0; width: 100%; padding: 12mm; box-shadow: none; background: #fff; }

    /* remove interactive elements and extra visuals */
    .guest-confirmation-printable .btn { display: none !important; }
    .guest-confirmation-printable .card { border: none !important; box-shadow: none !important; }
    .guest-confirmation-printable .small { font-size: 12px; }

    /* ensure lists and text are readable on print */
    .guest-confirmation-printable ul { margin: 0; padding-left: 1rem; }
    .guest-confirmation-printable li { margin-bottom: 0.25rem; }
  }

  @media screen {
    .guest-confirmation-printable { margin-top: 20dvh; }
  }
</style>

<div class="container py-5 guest-confirmation-printable">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8">
      <div class="card p-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div>
            <h2 class="h4 mb-0">Confirmare comandă</h2>
            <p class="mb-0 small text-muted">Număr comandă: <strong><%= @cart.public_order_number %></strong></p>
          </div>
          <div>
            <button class="btn btn-outline-secondary" onclick="window.print();">Print</button>
          </div>
        </div>

        <div class="mb-3">
          <p class="mb-1"><strong>Nume:</strong> <%= @cart.customer_full_name %></p>
          <p class="mb-1"><strong>Telefon:</strong> <%= @cart.customer_phone %></p>
          <p class="mb-1"><strong>Data:</strong> <%= l(@cart.created_at.in_time_zone(Time.zone), format: :long) %></p>
          <p class="mb-1"><strong>Metodă:</strong> <%= @cart.method_of_delivery == 'pickup' ? 'Ridicare' : 'Livrare' %></p>
          <% if @cart.delivery_address.present? %>
            <p class="mb-1"><strong>Adresă:</strong> <%= @cart.delivery_address %></p>
          <% end %>
        </div>

        <hr>

        <h5>Produse</h5>
        <ul class="list-unstyled">
          <% @cart.items.includes(:item_extras).each do |item| %>
            <li class="mb-2">
              <div class="d-flex justify-content-between">
                <div><strong><%= item.name %></strong> x <%= item.quantity %></div>
                <div><%= item.total.format %></div>
              </div>
              <% if item.item_extras.any? %>
                <ul class="small mb-0 text-muted">
                  <% item.item_extras.each do |ie| %>
                    <li>+ <%= ie.name %> — <%= ie.price.format %></li>
                  <% end %>
                </ul>
              <% end %>
            </li>
          <% end %>
        </ul>

        <hr>
        <div class="d-flex justify-content-between fw-bold">
          <div>Total</div>
          <div><%= @cart.total_money.format %></div>
        </div>

        <div class="mt-4 text-muted small">
          <p>Numărul de confirmare este unic. Poți folosi acest număr pentru a solicita detalii sau confirmare prin email la adresa <a href="mailto:<%= OrderMailer::ADMIN_EMAIL %>"><%= OrderMailer::ADMIN_EMAIL %></a>.</p>
        </div>
      </div>
    </div>
  </div>
</div>
