<div style="font-family: 'Helvetica Neue', Arial, sans-serif; background:#f6f8fb; padding:20px; color:#0b1220;">
  <div style="max-width:720px; margin:0 auto; background:#ffffff; border-radius:14px; overflow:hidden; box-shadow:0 14px 40px rgba(2,6,23,0.08);">
    <div style="background:linear-gradient(90deg,#0ea5a4,#7c3aed); padding:18px 22px; color:#fff;">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
        <div>
          <div style="font-size:12px; font-weight:700; text-transform:uppercase; opacity:0.9;">Notificare administrativă</div>
          <div style="font-size:18px; font-weight:800; margin-top:6px;">Comandă finalizată • ID #<%= @order.id %></div>
        </div>
        <div style="text-align:right; font-size:13px; opacity:0.95;">
          <%= l(@order.created_at.in_time_zone(Time.zone), format: :short) %>
        </div>
      </div>
    </div>

    <div style="padding:20px;">
      <div style="display:flex; gap:16px; flex-wrap:wrap;">
        <div style="flex:1 1 260px; border:1px solid #eef2f7; padding:12px; border-radius:10px; background:#fbfdff;">
          <div style="font-size:12px; text-transform:uppercase; color:#64748b; font-weight:700;">Client</div>
          <div style="margin-top:8px; font-size:15px; font-weight:700; color:#0b1220;"><%= @order.customer_name %></div>
          <div style="margin-top:6px; color:#475569; font-size:14px;">
            Telefon: <strong><%= @order.customer_phone.presence || '—' %></strong><br>
            Email: <strong><%= @order.contact_email || '—' %></strong>
          </div>
        </div>

        <div style="flex:1 1 260px; border:1px solid #eef2f7; padding:12px; border-radius:10px; background:#fbfdff;">
          <div style="font-size:12px; text-transform:uppercase; color:#64748b; font-weight:700;">Livrare</div>
          <div style="margin-top:8px; font-size:15px; font-weight:700; color:#0b1220;">
            <%= @order.method_of_delivery == 'pickup' ? 'Ridicare' : 'Livrare' %>
          </div>
          <div style="margin-top:6px; color:#475569; font-size:14px;">
            Data: <strong><%= @order.delivery_date.present? ? l(@order.delivery_date) : '—' %></strong><br>
            Județ: <strong><%= @order.county.presence || '—' %></strong><br>
            Adresă: <strong><%= @order.delivery_address.presence || '—' %></strong>
          </div>
        </div>
      </div>

      <% if @order.customer_notes.present? %>
        <div style="margin-top:14px; padding:12px; background:#fff7ed; border:1px solid #ffedd5; border-radius:10px; color:#92400e;">
          <strong>Notițe client:</strong>
          <div style="margin-top:6px; font-size:14px; color:#7c2d12;"><%= @order.customer_notes %></div>
        </div>
      <% end %>

      <div style="margin-top:18px; border:1px solid #eef2f7; border-radius:10px; overflow:hidden;">
        <div style="padding:12px 16px; background:#fbfdff; font-weight:700;">Articole (<%= @items.size %>)</div>
        <table style="width:100%; border-collapse:collapse; font-size:14px;">
          <thead>
            <tr style="text-align:left; border-bottom:1px solid #eef2f7; background:#fff;">
              <th style="padding:10px 14px;">Produs</th>
              <th style="padding:10px 14px;">Cantitate</th>
              <th style="padding:10px 14px; text-align:right;">Preț</th>
              <th style="padding:10px 14px; text-align:right;">Total</th>
            </tr>
          </thead>
          <tbody>
            <% @items.each do |item| %>
              <tr style="border-bottom:1px solid #fbfbfb;">
                <td style="padding:10px 14px; font-weight:700;"><%= item.name %></td>
                <td style="padding:10px 14px; color:#475569;"><%= item.quantity %> <%= item.kg_buc %></td>
                <td style="padding:10px 14px; text-align:right; color:#475569;"><%= item.price.format %></td>
                <td style="padding:10px 14px; text-align:right; font-weight:800;"><%= item.total.format %></td>
              </tr>
              <% if item.item_extras.any? %>
                <tr>
                  <td colspan="4" style="padding:6px 14px 12px 28px; color:#6b7280; font-size:13px;">
                    <strong>Extras:</strong>
                    <ul style="margin:6px 0 0 14px; padding:0;">
                      <% item.item_extras.each do |ie| %>
                        <li style="list-style:disc;"> <%= ie.name %> — <%= Money.new(ie.price_cents, Money.default_currency).format %></li>
                      <% end %>
                    </ul>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>

        <div style="display:flex; justify-content:space-between; align-items:center; padding:12px 16px; background:#fff;">
          <div style="font-size:14px; color:#475569;">Articole: <strong><%= @order.line_item_count %></strong></div>
          <div style="font-size:18px; font-weight:800; color:#0b1220;">Total: <%= @order.total_money.format %></div>
        </div>
      </div>

      <div style="margin-top:18px; display:flex; gap:10px; align-items:center;">
        <% if defined?(dashboard_order_url) %>
          <a href="<%= dashboard_order_url(@order) %>" style="display:inline-block; padding:10px 14px; background:#7c3aed; color:#fff; border-radius:8px; text-decoration:none; font-weight:700;">Vezi comanda în panou</a>
        <% end %>
        <a href="mailto:<%= OrderMailer::ADMIN_EMAIL %>?subject=Legat%20de%20comanda%20##<%= @order.id %>" style="display:inline-block; padding:10px 14px; border:1px solid #e6e9ef; background:#fff; color:#0b1220; border-radius:8px; text-decoration:none;">Contact admin</a>
      </div>
    </div>

    <div style="padding:14px 20px; background:#fbfdff; border-top:1px solid #eef2f7; text-align:center; color:#94a3b8; font-size:13px;">
      Irina Sweetshop • Comenzi online
    </div>
  </div>
</div>
