<div class="container py-5" style="margin-top: 20dvh;">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="h4 mb-1">Detalii Audit Log #<%= @audit_log.id %></h1>
      <p class="text-muted small mb-0">Informații detaliate despre această activitate</p>
    </div>
    <%= link_to '← Înapoi la listă', dashboard_audit_logs_path, class: 'btn btn-outline-secondary btn-sm' %>
  </div>

  <div class="row">
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-light">
          <h5 class="mb-0">Informații generale</h5>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-4">ID:</dt>
            <dd class="col-sm-8"><%= @audit_log.id %></dd>

            <dt class="col-sm-4">Acțiune:</dt>
            <dd class="col-sm-8">
              <% action_class = case @audit_log.action
                 when 'create' then 'success'
                 when 'update' then 'info'
                 when 'destroy' then 'danger'
                 when 'login' then 'primary'
                 when 'logout' then 'secondary'
                 when 'failed_login' then 'warning'
                 else 'secondary'
                 end %>
              <span class="badge bg-<%= action_class %>-subtle text-<%= action_class %>-emphasis">
                <%= @audit_log.human_action %>
              </span>
            </dd>

            <dt class="col-sm-4">Utilizator:</dt>
            <dd class="col-sm-8">
              <% if @audit_log.user %>
                <%= mail_to @audit_log.user.email %>
                <% if @audit_log.user.admin? %>
                  <span class="badge bg-success-subtle text-success-emphasis">Admin</span>
                <% end %>
              <% else %>
                <span class="text-muted fst-italic">System</span>
              <% end %>
            </dd>

            <dt class="col-sm-4">Data/Ora:</dt>
            <dd class="col-sm-8"><%= l(@audit_log.created_at, format: :long) %></dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-light">
          <h5 class="mb-0">Resursă afectată</h5>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-4">Tip:</dt>
            <dd class="col-sm-8">
              <%= @audit_log.auditable_type || '<span class="text-muted">N/A</span>'.html_safe %>
            </dd>

            <dt class="col-sm-4">ID:</dt>
            <dd class="col-sm-8">
              <%= @audit_log.auditable_id || '<span class="text-muted">N/A</span>'.html_safe %>
            </dd>

            <dt class="col-sm-4">Nume:</dt>
            <dd class="col-sm-8">
              <%= @audit_log.auditable_name %>
            </dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-light">
          <h5 class="mb-0">Detalii tehnicie</h5>
        </div>
        <div class="card-body">
          <dl class="row mb-0">
            <dt class="col-sm-4">IP Address:</dt>
            <dd class="col-sm-8">
              <code><%= @audit_log.ip_address %></code>
            </dd>

            <dt class="col-sm-4">User Agent:</dt>
            <dd class="col-sm-8">
              <small class="text-break"><%= @audit_log.user_agent %></small>
            </dd>

            <dt class="col-sm-4">Request ID:</dt>
            <dd class="col-sm-8">
              <code class="small"><%= @audit_log.request_id %></code>
            </dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-light">
          <h5 class="mb-0">Modificări</h5>
        </div>
        <div class="card-body">
          <% if @audit_log.change_data.present? %>
            <pre class="mb-0 bg-light p-3 rounded" style="max-height: 400px; overflow-y: auto;"><%= JSON.pretty_generate(@audit_log.change_data) %></pre>
          <% else %>
            <p class="text-muted mb-0">Nu există modificări înregistrate</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
