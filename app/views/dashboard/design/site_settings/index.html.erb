<div class="container-fluid py-5" style="margin-top: 20dvh; max-width: 1400px;">
  <!-- Header -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 gap-3">
    <div>
      <span class="badge rounded-pill px-3 py-2 mb-2" style="background: #f1f5f9; color: #475569; font-weight: 600;">
        <i class="fas fa-palette me-2"></i>Administrator / Design
      </span>
      <h1 class="h3 mb-0" style="color: #1e293b; font-weight: 700;">Setări Design Site</h1>
      <p class="text-muted small mb-0">Personalizează aspectul și culorile site-ului web</p>
    </div>
    <div class="d-flex gap-2">
      <%= link_to dashboard_path, class: 'btn btn-sm', style: 'background: white; color: #475569; border: 1px solid #e5e7eb; border-radius: 6px;' do %>
        <i class="fas fa-arrow-left me-2"></i>Înapoi la Dashboard
      <% end %>
    </div>
  </div>

  <!-- Navbar Settings Card -->
  <div class="card mb-4" style="border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden;">
    <div class="card-header py-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
      <h2 class="h5 mb-0 text-white" style="font-weight: 600;">
        <i class="fas fa-bars me-2"></i>Setări Navbar
      </h2>
    </div>
    <div class="card-body p-4">
      <%= form_with url: dashboard_design_site_settings_path, method: :patch, local: true, html: { class: 'needs-validation' } do |f| %>
        <%= hidden_field_tag 'site_setting[key]', 'navbar_color' %>
        <%= hidden_field_tag 'site_setting[description]', 'Culoarea de fundal a barei de navigare' %>
        
        <div class="row align-items-center">
          <div class="col-md-8">
            <div class="mb-3 mb-md-0">
              <label class="form-label fw-semibold mb-2" style="color: #1e293b;">
                <i class="fas fa-paint-brush me-2" style="color: #667eea;"></i>Culoare Navbar
              </label>
              <p class="small text-muted mb-3">
                Selectează culoarea de fundal pentru bara de navigare. Schimbarea va fi vizibilă imediat pe tot site-ul.
              </p>
              
              <div class="d-flex gap-3 align-items-center">
                <%= color_field_tag 'site_setting[value]', 
                    @navbar_color&.value || '#f8f9fa', 
                    class: 'form-control form-control-color', 
                    style: 'width: 80px; height: 50px; border-radius: 8px; cursor: pointer;',
                    id: 'navbar_color_picker' %>
                
                <div class="flex-grow-1">
                  <%= text_field_tag 'navbar_color_hex', 
                      @navbar_color&.value || '#f8f9fa', 
                      class: 'form-control', 
                      placeholder: '#f8f9fa',
                      style: 'border-radius: 8px;',
                      pattern: '^#[0-9A-Fa-f]{6}$' %>
                  <small class="form-text text-muted">Format: #RRGGBB (hex)</small>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-md-4 text-md-end">
            <div class="d-grid gap-2">
              <%= f.submit 'Salvează Schimbările', 
                  class: 'btn btn-lg', 
                  style: 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);' %>
            </div>
          </div>
        </div>

        <!-- Preview Section -->
        <div class="mt-4 p-4" style="background: #f8fafc; border-radius: 8px; border: 1px solid #e5e7eb;">
          <p class="small fw-semibold mb-3" style="color: #475569;">
            <i class="fas fa-eye me-2"></i>Preview Navbar
          </p>
          <div id="navbar_preview" 
               class="p-3 rounded" 
               style="background-color: <%= @navbar_color&.value || '#f8f9fa' %>; border: 2px solid #dee2e6; transition: background-color 0.3s ease;">
            <div class="d-flex align-items-center justify-content-between">
              <span style="font-weight: 600; color: #333;">Logo Site</span>
              <div class="d-flex gap-3">
                <span style="color: #666;">Meniu</span>
                <span style="color: #666;">Produse</span>
                <span style="color: #666;">Contact</span>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Preset Colors -->
  <div class="card" style="border: 1px solid #e5e7eb; border-radius: 12px;">
    <div class="card-header py-3" style="background: #f8fafc; border-bottom: 1px solid #e5e7eb;">
      <h3 class="h6 mb-0" style="color: #1e293b; font-weight: 600;">
        <i class="fas fa-swatchbook me-2"></i>Culori Prestabilite
      </h3>
    </div>
    <div class="card-body p-4">
      <p class="small text-muted mb-3">Alege rapid din aceste culori populare:</p>
      <div class="row g-3">
        <% preset_colors = [
          { name: 'Alb Standard', value: '#ffffff', text: '#333' },
          { name: 'Gri Deschis', value: '#f8f9fa', text: '#333' },
          { name: 'Navy Elegant', value: '#1e293b', text: '#fff' },
          { name: 'Mov Profesional', value: '#764ba2', text: '#fff' },
          { name: 'Verde Modern', value: '#10b981', text: '#fff' },
          { name: 'Roșu Cofetărie', value: '#ef4444', text: '#fff' }
        ] %>
        
        <% preset_colors.each do |preset| %>
          <div class="col-6 col-md-4 col-lg-2">
            <button type="button" 
                    class="preset-color-btn w-100 p-3 rounded" 
                    data-color="<%= preset[:value] %>"
                    style="background: <%= preset[:value] %>; border: 2px solid #e5e7eb; cursor: pointer; transition: all 0.2s;">
              <div class="text-center" style="color: <%= preset[:text] %>; font-size: 0.75rem; font-weight: 600;">
                <%= preset[:name] %>
              </div>
              <div class="text-center mt-2" style="color: <%= preset[:text] %>; font-size: 0.7rem; opacity: 0.8;">
                <%= preset[:value] %>
              </div>
            </button>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Info Alert -->
  <div class="alert alert-info mt-4 d-flex align-items-start" style="border-radius: 8px; border-left: 4px solid #3b82f6;">
    <i class="fas fa-info-circle me-3 mt-1" style="color: #3b82f6;"></i>
    <div>
      <strong>Nota:</strong> Modificările vor fi aplicate imediat pe întreg site-ul. 
      Asigură-te că alegi o culoare care se potrivește cu brandul și că textul rămâne lizibil.
    </div>
  </div>
</div>

<script>
  // Sync color picker with hex input
  const colorPicker = document.getElementById('navbar_color_picker');
  const hexInput = document.getElementById('navbar_color_hex');
  const preview = document.getElementById('navbar_preview');

  if (colorPicker && hexInput && preview) {
    colorPicker.addEventListener('input', function() {
      hexInput.value = this.value;
      preview.style.backgroundColor = this.value;
    });

    hexInput.addEventListener('input', function() {
      if (/^#[0-9A-Fa-f]{6}$/.test(this.value)) {
        colorPicker.value = this.value;
        preview.style.backgroundColor = this.value;
      }
    });

    // Preset color buttons
    document.querySelectorAll('.preset-color-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const color = this.dataset.color;
        colorPicker.value = color;
        hexInput.value = color;
        preview.style.backgroundColor = color;
      });
      
      // Hover effect
      btn.addEventListener('mouseenter', function() {
        this.style.transform = 'scale(1.05)';
        this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
      });
      
      btn.addEventListener('mouseleave', function() {
        this.style.transform = 'scale(1)';
        this.style.boxShadow = 'none';
      });
    });
  }
</script>
