<style>
  .modern-dashboard {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  }
  
  .modern-header {
    background: #1e293b;
    border-radius: 12px;
    padding: 2.5rem 2rem;
    color: white;
    margin-bottom: 2rem;
    position: relative;
  }
  
  .modern-header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    letter-spacing: -0.5px;
  }
  
  .modern-header .subtitle {
    font-size: 1.1rem;
    opacity: 0.95;
    font-weight: 400;
  }
  
  .modern-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(255, 255, 255, 0.15);
    padding: 0.375rem 0.875rem;
    border-radius: 6px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  .modern-stat-card {
    background: white;
    border-radius: 8px;
    padding: 1.5rem;
    border: 1px solid #e5e7eb;
    height: 100%;
  }
  
  .stat-icon {
    width: 48px;
    height: 48px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    margin-bottom: 1rem;
  }
  
  .stat-icon-1 { background: #1e293b; }
  .stat-icon-2 { background: #475569; }
  .stat-icon-3 { background: #64748b; }
  .stat-icon-4 { background: #334155; }
  
  .stat-label {
    font-size: 0.875rem;
    color: #6b7280;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.5rem;
  }
  
  .stat-value {
    font-size: 2.25rem;
    font-weight: 700;
    color: #111827;
    line-height: 1;
    margin-bottom: 0.5rem;
  }
  
  .stat-hint {
    font-size: 0.875rem;
    color: #9ca3af;
    font-weight: 400;
  }
  
  .section-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #111827;
    margin-bottom: 1.5rem;
    letter-spacing: -0.5px;
  }
  
  .modern-action-card {
    background: white;
    border-radius: 8px;
    padding: 1.5rem;
    border: 1px solid #e5e7eb;
    height: 100%;
    display: flex;
    flex-direction: column;
  }
  
  .modern-action-card:hover {
    border-color: #cbd5e1;
  }
  
  .action-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.125rem;
    color: white;
    margin-bottom: 1rem;
    background: #1e293b;
  }
  
  .action-title {
    font-size: 1rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
  }
  
  .action-description {
    font-size: 0.875rem;
    color: #6b7280;
    margin-bottom: 1.25rem;
    flex-grow: 1;
  }
  
  .modern-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.625rem 1.25rem;
    border-radius: 10px;
    font-weight: 600;
    font-size: 0.875rem;
    transition: all 0.2s ease;
    border: none;
    text-decoration: none;
  }
  
  .modern-btn-primary {
    background: #1e293b;
    color: white;
  }
  
  .modern-btn-primary:hover {
    background: #0f172a;
    color: white;
  }
  
  .modern-btn-outline {
    background: transparent;
    border: 2px solid #e5e7eb;
    color: #374151;
  }
  
  .modern-btn-outline:hover {
    background: #f9fafb;
    border-color: #d1d5db;
  }
  
  .modern-table-card {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid #e5e7eb;
  }
  
  .modern-table-header {
    padding: 1.5rem 1.75rem;
    border-bottom: 1px solid #f3f4f6;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .modern-table-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: #111827;
    margin: 0;
  }
  
  .modern-table {
    margin: 0;
  }
  
  .modern-table thead th {
    background: #f9fafb;
    color: #6b7280;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 1rem 1.5rem;
    border: none;
  }
  
  .modern-table tbody td {
    padding: 1.25rem 1.5rem;
    border-top: 1px solid #f3f4f6;
    font-size: 0.9375rem;
  }
  
  .modern-table tbody tr:hover {
    background: #f9fafb;
  }
  
  .revenue-card {
    background: #334155;
    border-radius: 8px;
    padding: 1.5rem;
    color: white;
  }
  
  .revenue-label {
    font-size: 0.875rem;
    opacity: 0.9;
    margin-bottom: 0.5rem;
  }
  
  .revenue-value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
  }
  
  .revenue-subtitle {
    font-size: 0.875rem;
    opacity: 0.85;
  }
  
  .floating-nav {
    position: fixed;
    right: 2rem;
    top: 50%;
    transform: translateY(-50%);
    z-index: 100;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    background: white;
    padding: 0.75rem;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }
  
  .floating-nav a {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    color: #6b7280;
    transition: all 0.2s ease;
    text-decoration: none;
  }
  
  .floating-nav a:hover {
    background: #f1f5f9;
    color: #1e293b;
  }
  
  @media (max-width: 768px) {
    .modern-header h1 {
      font-size: 1.75rem;
    }
    
    .stat-value {
      font-size: 1.75rem;
    }
    
    .floating-nav {
      display: none;
    }
  }
</style>

<div class="container py-5 modern-dashboard" style="margin-top: 12vh;">
  <!-- Floating Navigation -->
  <nav class="floating-nav d-none d-lg-flex">
    <a href="#top" title="Sus"><i class="fa-solid fa-chevron-up"></i></a>
    <a href="#stats" title="Statistici"><i class="fa-solid fa-chart-line"></i></a>
    <a href="#quick-links" title="Acțiuni rapide"><i class="fa-solid fa-bolt"></i></a>
    <a href="#orders" title="Comenzi"><i class="fa-solid fa-receipt"></i></a>
    <a href="#users-admin" title="Utilizatori"><i class="fa-solid fa-users"></i></a>
  </nav>

  <!-- Modern Header -->
  <div class="modern-header" id="top">
    <div class="row align-items-center">
      <div class="col-lg-8 position-relative" style="z-index: 1;">
        <div class="modern-badge">
          <i class="fa-solid fa-shield-halved"></i>
          Administrator
        </div>
        <h1>Salut, <%= current_user&.name_from_mail || current_user&.email %></h1>
        <p class="subtitle mb-0">Monitorizează comenzile, actualizează conținutul și păstrează experiența clienților impecabilă.</p>
      </div>
      <div class="col-lg-4 mt-4 mt-lg-0" style="z-index: 1;">
        <div class="revenue-card">
          <div class="revenue-label">Venit luna curentă</div>
          <div class="revenue-value"><%= @revenue_this_month.format %></div>
          <div class="revenue-subtitle">Total acumulat: <strong><%= @revenue_all_time.format %></strong></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Stats Section -->
  <div class="row g-4 mb-5" id="stats">
    <% @stats_cards.each_with_index do |stat, index| %>
      <div class="col-12 col-sm-6 col-xl-3">
        <div class="modern-stat-card">
          <div class="stat-icon stat-icon-<%= index + 1 %> text-white">
            <i class="<%= stat[:icon] %>"></i>
          </div>
          <div class="stat-label"><%= stat[:label] %></div>
          <% value = stat[:value] %>
          <div class="stat-value"><%= value.is_a?(Numeric) ? number_with_delimiter(value) : value %></div>
          <% hint_value = stat[:hint_value] %>
          <% hint_label = stat[:hint_label] %>
          <% hint_text = if hint_label.present?
                           hint_value.nil? ? hint_label : "#{number_with_delimiter(hint_value)} #{hint_label}"
                         else
                           ''
                         end %>
          <div class="stat-hint"><%= hint_text %></div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Quick Actions -->
  <div id="quick-links" class="mb-5">
    <h2 class="section-title">Acțiuni rapide</h2>
    <div class="row g-4">
      <% @quick_links.each_with_index do |link, index| %>
        <div class="col-12 col-md-6 col-xl-4">
          <div class="modern-action-card">
            <div class="action-icon">
              <i class="<%= link[:icon] %>"></i>
            </div>
            <div class="action-title"><%= link[:title] %></div>
            <div class="action-description"><%= link[:description] %></div>
            <%= link_to link[:path], class: 'modern-btn modern-btn-primary' do %>
              Deschide
              <i class="fa-solid fa-arrow-right"></i>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Orders and Reviews Section -->
  <div class="row g-4 mb-5" id="orders">
    <div class="col-lg-8">
      <div class="modern-table-card">
        <div class="modern-table-header">
          <h3 class="modern-table-title">Comenzi recente</h3>
          <%= link_to dashboard_orders_path, class: 'modern-btn modern-btn-outline' do %>
            Vezi toate
            <i class="fa-solid fa-arrow-right"></i>
          <% end %>
        </div>
        <div class="table-responsive">
          <table class="table modern-table align-middle mb-0">
            <thead>
              <tr>
                <th>ID</th>
                <th>Client</th>
                <th>Status</th>
                <th>Total</th>
                <th>Creată</th>
              </tr>
            </thead>
            <tbody>
              <% if @recent_orders.any? %>
                <% @recent_orders.each do |order| %>
                  <tr>
                    <td><strong>#<%= order.id %></strong></td>
                    <td>
                      <div><%= order.customer_name %></div>
                      <div class="text-muted small"><%= order.contact_email || '—' %></div>
                    </td>
                    <td>
                      <span class="badge rounded-pill bg-<%= order.status_badge_variant %>"><%= order.status_label %></span>
                    </td>
                    <td><strong><%= order.total_money.format %></strong></td>
                    <td class="text-muted"><%= l(order.created_at, format: :short) %></td>
                  </tr>
                <% end %>
              <% else %>
                <tr>
                  <td colspan="5" class="text-center text-muted py-5">
                    <i class="fa-solid fa-inbox fa-2x mb-3 d-block opacity-25"></i>
                    Nu există comenzi recente
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="modern-table-card mb-4">
        <div class="modern-table-header">
          <h3 class="modern-table-title">Recenzii în așteptare</h3>
          <span class="badge rounded-pill" style="background: #f1f5f9; color: #475569; font-weight: 600;"><%= @pending_reviews.size %></span>
        </div>
        <div class="list-group list-group-flush">
          <% if @pending_reviews.any? %>
            <% @pending_reviews.each do |review| %>
              <% reviewable = review.reviewable %>
              <% review_path = case reviewable
                              when Recipe
                                recipe_path(reviewable)
                              when Cakemodel
                                cakemodel_path(reviewable)
                              else
                                nil
                              end %>
              <div class="list-group-item border-0 py-3">
                <div class="d-flex justify-content-between mb-2">
                  <strong style="color: #111827;"><%= review.author %></strong>
                  <span class="badge rounded-pill" style="background: #f1f5f9; color: #475569;"><%= review.rating %>/5</span>
                </div>
                <p class="small text-muted mb-2"><%= truncate(review.content, length: 100) %></p>
                <div class="d-flex justify-content-between align-items-center">
                  <span class="text-muted small"><%= l(review.created_at, format: :short) %></span>
                  <% if review_path.present? %>
                    <%= link_to review_path, class: 'small', style: 'color: #1e293b; text-decoration: none; font-weight: 600;' do %>
                      Vezi <i class="fa-solid fa-arrow-right"></i>
                    <% end %>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% else %>
            <div class="list-group-item border-0 text-center py-5 text-muted">
              <i class="fa-solid fa-star fa-2x mb-3 d-block opacity-25"></i>
              Nu există recenzii de aprobat
            </div>
          <% end %>
        </div>
      </div>
      
      <div class="modern-stat-card" style="background: #f8fafc; border: 1px solid #e2e8f0;">
        <div style="color: #334155;">
          <div style="font-size: 1rem; font-weight: 600; margin-bottom: 0.75rem;">
            <i class="fa-solid fa-lightbulb me-2"></i>Note interne
          </div>
          <p style="font-size: 0.875rem; margin-bottom: 0; opacity: 0.9;">
            Folosește secțiunea de comenzi pentru a adăuga notițe interne și a urmări statusul livrărilor.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Users Section -->
  <div class="row g-4" id="users-admin">
    <div class="col-lg-8">
      <div class="modern-table-card">
        <div class="modern-table-header">
          <h3 class="modern-table-title">Utilizatori recenți</h3>
          <%= link_to new_user_registration_path, class: 'modern-btn modern-btn-primary' do %>
            <i class="fa-solid fa-user-plus me-2"></i>Invită utilizator
          <% end %>
        </div>
        <div class="table-responsive">
          <table class="table modern-table align-middle mb-0">
            <thead>
              <tr>
                <th>Email</th>
                <th>Rol</th>
                <th>Comenzi</th>
                <th>Creat</th>
                <th>Acțiuni</th>
              </tr>
            </thead>
            <tbody>
              <% if @recent_users.any? %>
                <% @recent_users.each do |user| %>
                  <% completed_orders = user.carts.select { |cart| cart.status == Cart::STATUSES[:delivered] } %>
                  <tr>
                    <td><strong><%= user.email %></strong></td>
                    <td>
                      <% if user.admin? %>
                        <span class="badge rounded-pill" style="background: #1e293b; color: white; font-weight: 600;">Admin</span>
                      <% else %>
                        <span class="badge rounded-pill" style="background: #f1f5f9; color: #64748b; font-weight: 600;">Client</span>
                      <% end %>
                    </td>
                    <td><strong><%= number_with_delimiter(completed_orders.count) %></strong> finalizate</td>
                    <td class="text-muted"><%= l(user.created_at, format: :short) %></td>
                    <td>
                      <div class="btn-group btn-group-sm">
                        <%= link_to edit_dashboard_user_path(user), class: 'modern-btn modern-btn-outline', style: 'padding: 0.375rem 0.75rem;' do %>
                          <i class="fa-solid fa-pen"></i>
                        <% end %>
                        <% if user != current_user %>
                          <% if user.admin? %>
                            <%= button_to toggle_admin_dashboard_user_path(user), method: :patch, data: { confirm: 'Sigur vrei să retragi dreptul de administrator?' }, class: 'modern-btn modern-btn-outline', style: 'padding: 0.375rem 0.75rem; border-color: #cbd5e1; color: #475569;' do %>
                              <i class="fa-solid fa-user-shield"></i>
                            <% end %>
                          <% else %>
                            <%= button_to toggle_admin_dashboard_user_path(user), method: :patch, data: { confirm: 'Sigur vrei să promovezi utilizatorul la administrator?' }, class: 'modern-btn modern-btn-outline', style: 'padding: 0.375rem 0.75rem; border-color: #cbd5e1; color: #475569;' do %>
                              <i class="fa-solid fa-arrow-up"></i>
                            <% end %>
                          <% end %>
                        <% end %>
                      </div>
                    </td>
                  </tr>
                <% end %>
              <% else %>
                <tr>
                  <td colspan="5" class="text-center text-muted py-5">
                    <i class="fa-solid fa-users fa-2x mb-3 d-block opacity-25"></i>
                    Nu există utilizatori recenți
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="modern-stat-card mb-4" style="background: #f8fafc; border: 1px solid #e2e8f0;">
        <div style="color: #334155;">
          <div style="font-size: 1rem; font-weight: 600; margin-bottom: 1.25rem;">
            <i class="fa-solid fa-chart-pie me-2"></i>Statistici utilizatori
          </div>
          <% @user_metrics.each do |metric| %>
            <div class="d-flex justify-content-between align-items-center mb-3">
              <span style="font-size: 0.875rem; opacity: 0.8;"><%= metric[:label] %></span>
              <strong style="font-size: 1.25rem;"><%= number_with_delimiter(metric[:value]) %></strong>
            </div>
          <% end %>
        </div>
      </div>
      
      <div class="modern-action-card">
        <div class="action-icon">
          <i class="fa-solid fa-users-gear"></i>
        </div>
        <div class="action-title">Gestionare acces</div>
        <div class="action-description">Administrează conturile de utilizator, promovează la admin sau șterge conturi direct din panoul dedicat.</div>
        <%= link_to dashboard_admin_users_path, class: 'modern-btn modern-btn-primary' do %>
          Administrare utilizatori
          <i class="fa-solid fa-arrow-right"></i>
        <% end %>
      </div>
    </div>
  </div>
</div>