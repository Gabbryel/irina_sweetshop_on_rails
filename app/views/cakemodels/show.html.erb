<% if @cakemodel.photo.present? %>
  <% content_for :meta_image, cl_image_path(@cakemodel.photo.key) %>
<% end %>
<% content_for :meta_description, @cakemodel.content %>
<div class="recipe-show-container">
  <div class="recipe-show-back-btn">
    <!-- <%= render 'partials/back_buttons' %> -->
  </div>
  <div class="recipe-show-main">
      <div class="recipe-show-main-image">
        <%= cl_image_tag @cakemodel.photo.key, alt: @cakemodel.content %>
      </div>
      <div class="recipe-show-main-description">
        <h1><%= "#{@cakemodel.name}" %></h1>
        <% @cakemodel.content.split('.').each do |line| %>
          <p class="recipe-show-main-description__text"><%= line %>.</p>
        <% end %>
        <div class="btn-next-prev-container">
          <% curr_id, next_id, prev_id, prev_text, next_text = next_prev(@cakemodels, @cakemodel) %>
          <% if prev_id && curr_id > 0 %>
            <%= link_to "#{prev_text}", cakemodel_path(prev_id), class: 'btn-next-prev' %>
          <% end %>
          <% if next_id %>
            <%= link_to "#{next_text}", cakemodel_path(next_id), class: 'btn-next-prev' %>
          <% end %>
        </div>
      </div>
    </div>
    
    <div class="recipe-show-ratings">
      <h2>Ratings & reviews </h2>
      <div class="recipe-show-ratings-container">
        <div class="recipe-show-ratings-reviews-form">
          <!-- <%= render 'partials/reviews_new_form' %> -->
          <%= simple_form_for([ @cakemodel, @review ]) do |f| %>
            <%= f.input :rating, collection: %i[1 2 3 4 5], label: 'Rating de la 1 la 5' %>
            <%= f.input :content, required: true, input_html: { minlength: 10 }, label: 'Recenzie' %>
            <%= f.button :submit, value: 'Posteaza recenzia', class: 'btn-default' %>
          <% end %>
        </div>
        <div class="recipe-show-ratings-reviews-container">
          <!-- <%= render 'partials/reviews_index' %> -->
          <% @cakemodel.reviews.each do |rev| %>
            <div class="recipe-reviews-card">
              <p><%= "Recenzie (id:#{rev.id}) - Rating: #{ "⭐️" * rev.rating} (#{rev.rating})" %></p>
              <p><%= rev.content %></p>
              <p><%= "Autor: #{rev.author}" %></p>
              <p><%= "Scrisă la: #{rev.created_at.to_s.split(' ')[0]}" %></p>
            </div>
          <% end %>
        </div>
      </div>
    </div>

</div>